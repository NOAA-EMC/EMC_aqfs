
<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<META NAME="MSSmartTagsPreventParsing" CONTENT="TRUE"> 
<TITLE> UNGRIDB() and UNGRIDI()</TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFFF" 
      TOPMARGIN="15" 
      MARGINHEIGHT="15" 
      LEFTMARGIN="15" 
      MARGINWIDTH="15">

<H1>    UNGRIDB() and UNGRIDI() </H1>

<H2> Fortran version: </H2>
<PRE>
    SUBROUTINE UNGRIDB( NCOLS, NROWS, XORIG, YORIG, XCELL, YCELL,
   &amp;                   NPTS, XLOC, YLOC, NU, CU )
        INTEGER         NCOLS, NROWS    !  number of grid columns, rows
        REAL*8          XORIG, YORIG    !  X,Y coords of LL grid corner
        REAL*8          XCELL, YCELL    !  X,Y direction cell size
        INTEGER         NPTS            !  number of (point-source) locations
        REAL            XLOC( NPTS )    !  X point coordinates
        REAL            YLOC( NPTS )    !  Y point coordinates
        INTEGER         NU( 4,NPTS )    !  single-indexed subscripts into grid
        REAL            CU( 4,NPTS )    !  coefficients

    SUBROUTINE UNGRIDI( NCOLS, NROWS, XORIG, YORIG, XCELL, YCELL,
   &amp;                   NPTS, XLOC, YLOC, NX )
        INTEGER         NCOLS, NROWS    !  number of grid columns, rows
        REAL*8          XORIG, YORIG    !  X,Y coords of LL grid corner
        REAL*8          XCELL, YCELL    !  X,Y direction cell size
        INTEGER         NPTS            !  number of (point-source) locations
        REAL            XLOC( NPTS )    !  X point coordinates
        REAL            YLOC( NPTS )    !  Y point coordinates
        INTEGER           NX( NPTS )    !  single-indexed subscripts into grid
</PRE><P> 

<H2> C version:  none </H2>

<H2> Summary: </H2>

    UNGRIDB() computes &quot;ungridding&quot; matrices used by subroutine
    <A HREF = "BMATVEC.html">BMATVEC</A> to perform bilinear interpolation 
    from a grid to a set of target (e.g., point source) locations 
    <BLOCKQUOTE>
    <VAR>{ &lt;XLOC(S),YLOC(S)&gt;, S=1, ..., NPTS }</VAR>
    </BLOCKQUOTE>
    More detail on the computation of these coefficients, etc., is
    given in the <A HREF = "BMATVEC.html">section on BMATVEC()</A>.
    <P> 

    UNGRIDI() computes &quot;<EM>incidence matrix</EM> ungridding&quot;
    indices for grid-to-grid transformation from a grid to the set of
    target (e.g., point source) locations as specified above, i.e., so
    that for a variable <VAR>V(NCOLS*NROWS)</VAR> single-indexed on the
    source grid,
    <BLOCKQUOTE>
    <VAR>VNEW(S)&nbsp;=&nbsp;V(NX(S))</VAR> is the value at <VAR>{
    &lt;XLOC(S),YLOC(S)&gt;</VAR>
    </BLOCKQUOTE>    
    <P>

    See also subroutines
    <BLOCKQUOTE>
    <A HREF = "BMATVEC.html">BMATVEC and BILIN</A>,
    <A HREF = "DMATVEC.html">DMATVEC</A>,
    <A HREF = "PMATVEC.html">PMATVEC</A>, and
    <A HREF = "SMATVEC.html">SMATVEC</A>
    </BLOCKQUOTE>
    and programs
    <BLOCKQUOTE>
    <A HREF = "MTXBLEND.html">MTXBLEND</A>,
    <A HREF = "MTXBUILD.html">MTXBUILD</A>,
    <A HREF = "MTXCALC.html">MTXCALC</A>,
    <A HREF = "MTXCPLE.html">MTXCPLE</A>.
    </BLOCKQUOTE>
    <P> 

<H2> Fortran Usage: </H2>

    For Fortran-90 declarations and interface checking:    
    <PRE>
    <A HREF = "M3UTILIO.html">USE M3UTILIO</A>
    </PRE><P>
    
    <VAR>!! under construction !!</VAR> 
    (see <A HREF = "BMATVEC.html">BMATVEC</A>)

<HR> <!----------------------------------------------------------------->
    
<A HREF = "SETSPHERE.html" >
Previous:  <STRONG>SETSPHERE and SPHEREDAT</STRONG>
</A><P> 

<A HREF = "TRIMLEN.html" >
Previous:  <STRONG>TRIMLEN</STRONG>
</A><P> 

<A HREF = "UPCASE.html" >
Next:  <STRONG>UPCASE</STRONG>
</A><P> 

<A HREF = "AA.html#coordstuff"> 
Up: <STRONG>Coordinate and Grid Related Routines</STRONG> 
</A><P> 

<A HREF = "AA.html#utility"> 
Up: <STRONG>Utility Routines</STRONG> 
</A><P> 

<A HREF = "AA.html"> 
To: <STRONG>Models-3/EDSS I/O API:   The Help Pages</STRONG> 
</A><P> 

</BODY>
</HTML>

